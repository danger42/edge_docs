  {% extends "_base.html" %} {% block title %}JSONThreatProtection policy{% endblock %} {% block body %} <img src="/api-platform/images/icon_policy_threat-protection.jpg">

  <h3>What</h3>

  <p>Minimizes the risk posed by content-level attacks by enabling you to specify limits on various
  JSON structures, such as arrays and strings.</p>

  <aside class="note"><b>Note:</b> This policy executes only if the <code>Content-Type</code> of
  the request or response header is set to <code>application/json.</code></aside>

  <div class="video"> 
    <p><strong>Video:</strong> Watch a short video to learn more about how the JSON Threat
    Protection policy enables you to secure APIs against content-level attacks.</p>

    <div style="text-align: left; margin:15px">
      <iframe allowfullscreen="" frameborder="0" height="480" src=
      "https://www.youtube.com/embed/LIUeaAvRuTQ" width="854"></iframe>
    </div>
  </div>

  <h2 id="watchashortvideoonthreatprotection">Watch a short video on threat protection </h2>

  <div class="video">
    <p><strong>Video:</strong> Check out this short video about threat protection
    policies.</p>

    <div style="text-align: left; margin:15px">
      <iframe allowfullscreen="" frameborder="0" height="480" src=
      "https://www.youtube.com/embed/rC8kZJgwBFM?list=PLIXjuPlujxxxe3iTmLtgfIBgpMo7iD7fk" width=
      "854"></iframe>
    </div>
  </div>

  <h2 id="elementreference">Element reference</h2>

  <p>The element reference describes the elements and attributes of the JSONThreatProtection
  policy.</p>
  <pre class="prettyprint">
&lt;JSONThreatProtection async="false" continueOnError="false" enabled="true" name="JSON-Threat-Protection-1"&gt;
   &lt;DisplayName&gt;JSON Threat Protection 1&lt;/DisplayName&gt;
   &lt;ArrayElementCount&gt;20&lt;/ArrayElementCount&gt;
   &lt;ContainerDepth&gt;10&lt;/ContainerDepth&gt;
   &lt;ObjectEntryCount&gt;15&lt;/ObjectEntryCount&gt;
   &lt;ObjectEntryNameLength&gt;50&lt;/ObjectEntryNameLength&gt;
   &lt;Source&gt;request&lt;/Source&gt;
   &lt;StringValueLength&gt;500&lt;/StringValueLength&gt;
&lt;/JSONThreatProtection&gt;
</pre>

  <h2 id="jsonthreatprotectionattributes">&lt;JSONThreatProtection&gt; attributes</h2>
  <pre class="prettyprint">
&lt;JSONThreatProtection async="false" continueOnError="false" enabled="true" name="JSON-Threat-Protection-1"&gt; 
</pre>{% dynamic include /includes/___policies-parent-element-attributes %}

  <h2 id="arrayelementcountelement">&lt;ArrayElementCount&gt; element</h2>

  <p>Specifies the maximum number of elements allowed in an array.</p>
  <pre class="prettyprint">
&lt;ArrayElementCount&gt;20&lt;/ArrayElementCount&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>If you do not specify this element, or if you specify a negative integer, the system
        does not enforce a limit.</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>Integer</td>
      </tr>
    </tbody>
  </table>

  <h2 id="containerdepthelement">&lt;ContainerDepth&gt; element</h2>

  <p>Specifies the maximum allowed containment depth, where the containers are objects or arrays.
  For example, an array containing an object which contains an object would result in a containment
  depth of 3.</p>
  <pre class="prettyprint">
&lt;ContainerDepth&gt;10&lt;/ContainerDepth&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>If you do not specify this element, or if you specify a negative integer, the system
        does not enforce any limit.</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>Integer</td>
      </tr>
    </tbody>
  </table>

  <h2 id="objectentrycountelement">&lt;ObjectEntryCount&gt; element</h2>

  <p>Specifies the maximum number of entries allowed in an object.</p>
  <pre class="prettyprint">
&lt;ObjectEntryCount&gt;15&lt;/ObjectEntryCount&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>If you do not specify this element, or if you specify a negative integer, the system
        does not enforce any limit.</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>Integer</td>
      </tr>
    </tbody>
  </table>

  <h2 id="objectentrynamelengthelement">&lt;ObjectEntryNameLength&gt; element</h2>

  <p>Specifies the maximum string length allowed for a property name within an object.</p>
  <pre class="prettyprint">
&lt;ObjectEntryNameLength&gt;50&lt;/ObjectEntryNameLength&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>If you do not specify this element, or if you specify a negative integer, the system
        does not enforce a limit.</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>Integer</td>
      </tr>
    </tbody>
  </table>

  <h2 id="sourceelement">&lt;Source&gt; element</h2>

  <p>Message to be screened for JSON payload attacks. This is most commonly set to
  <code>request</code>, as you will typically need to validate inbound requests from client apps.
  When set to <code>message</code>, this element will automatically evaluate the request message
  when attached to the request flow and the response message when attached to the response
  flow.</p>
  <pre class="prettyprint">
&lt;Source&gt;request&lt;/Source&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>request</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>
          <p>String.</p>

          <p>Valid values: request, response, or message.</p>
        </td>
      </tr>
    </tbody>
  </table>

  <h2 id="stringvaluelengthelement">&lt;StringValueLength&gt; element</h2>

  <p>Specifies the maximum length allowed for a string value.</p>
  <pre class="prettyprint">
&lt;StringValueLength&gt;500&lt;/StringValueLength&gt;
</pre>

  <table class="columns">
    <tbody>
      <tr>
        <td><b>Default:</b></td>

        <td>If you do not specify this element, or if you specify a negative integer, the system
        does not enforce a limit.</td>
      </tr>

      <tr>
        <td><b>Presence:</b></td>

        <td>Optional</td>
      </tr>

      <tr>
        <td><b>Type:</b></td>

        <td>Integer</td>
      </tr>
    </tbody>
  </table>

  <h2 id="errorcodes">Error reference</h2>

  <aside class="note"><b>Note:</b> This policy executes only if the <code>Content-Type</code> of
  the request or response header is set to <code>application/json.</code></aside>

  <p>{% dynamic include /includes/___json-threat-protection-policy-error-codes %}</p>

  <h2 id="schemas">Schemas</h2>

  <aside class="note"><b>Sample:</b> See our <a href=
  "https://github.com/apigee/api-platform-samples/tree/master/schemas/policy">GitHub
  repository</a> samples for the most recent schemas.</aside>

  <h2 id="usagenotes">Usage notes</h2>

  <p>Like XML-based services, APIs that support JavaScript object notation (JSON) are vulnerable to
  content-level attacks. Simple JSON attacks attempt to use structures that overwhelm JSON parsers
  to crash a service and induce application-level denial-of-service attacks. All settings are
  optional and should be tuned to optimize your service requirements against potential
  vulnerabilities.</p>

  <h2 id="relatedtopics">Related topics</h2>

  <p><a href="/api-platform/reference/policies/json-xml-policy.html">JSON to XML policy</a></p>

  <p><a href="/api-platform/reference/policies/xml-threat-protection-policy.html">XML Threat
  Protection policy</a></p>

  <p><a href="/api-platform/reference/policies/regular-expression-protection.html">Regular
  Expression Protection policy</a></p>

  {% endblock %}
